---
permalink: ilm/example-8-priorities-for-s3-bucket-lifecycle-and-ilm-policy.html 
sidebar: sidebar 
keywords: retention priority, example S3 bucket lifecycle, example ILM policy 
summary: 根據您的生命週期組態、物件會遵循 S3 儲存區生命週期或 ILM 原則的保留設定。 
---
= 範例 8 ： S3 儲存區生命週期和 ILM 原則的優先順序
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
根據您的生命週期組態、物件會遵循 S3 儲存區生命週期或 ILM 原則的保留設定。



== 儲存庫生命週期的範例優先於 ILM 原則

ILM原則::
+
--
* 根據非目前時間參考的規則：在第 0 天、保留 X 份 20 天
* 規則依據擷取時間參考（預設）：在第 0 天、保留 X 份 50 天


--
貯體生命週期:: `"Filter": {"Prefix": "docs/"}, "Expiration": {"Days": 100}, "NoncurrentVersionExpiration": {"NoncurrentDays": 5}`
結果::
+
--
* 已擷取名為「 DOCS/ 文字」的物件。符合貯體生命週期篩選器的「 DOCS/ 」前置詞。
+
** 100 天之後、系統會建立刪除標記、而「文件 / 文字」會變成非目前的。
** 5 天之後、自擷取「文件 / 文字」後總共有 105 天被刪除。
** 在 95 天之後、自擷取後總共 200 天、刪除標記建立後 100 天、刪除過期的刪除標記。


* 正在擷取名為「影片 / 影片」的物件。它與篩選器不符、並使用 ILM 保留原則。
+
** 50 天後、系統會建立刪除標記、並將「影片 / 影片」變成非目前的。
** 20 天後、自擷取影片後的 70 天內、「影片 / 影片」會被刪除。
** 30 天後、自擷取後的總計 100 天、以及刪除標記建立後的 50 天、刪除過期的刪除標記。




--




== 儲存貯體生命週期的範例則隱含永久保存

ILM原則::
+
--
* 根據非目前時間參考的規則：在第 0 天、保留 X 份 20 天
* 規則依據擷取時間參考（預設）：在第 0 天、保留 X 份 50 天


--
貯體生命週期:: `"Filter": {"Prefix": "docs/"}, "Expiration": {"ExpiredObjectDeleteMarker": true}`
結果::
+
--
* 已擷取名為「 DOCS/ 文字」的物件。符合貯體生命週期篩選器的「 DOCS/ 」前置詞。
+
此 `Expiration`動作僅適用於過期的刪除標記、這意味著將其他所有項目永遠保留（從「 docs/ 」開始）。

+
刪除以「 DOCS/ 」開頭的標記會在過期時移除。

* 正在擷取名為「影片 / 影片」的物件。它與篩選器不符、並使用 ILM 保留原則。
+
** 50 天後、系統會建立刪除標記、並將「影片 / 影片」變成非目前的。
** 20 天後、自擷取影片後的 70 天內、「影片 / 影片」會被刪除。
** 30 天後、自擷取後的總計 100 天、以及刪除標記建立後的 50 天、刪除過期的刪除標記。




--




== 使用貯體生命週期來複製 ILM 並清除過期刪除標記的範例

ILM原則::
+
--
* 根據非目前時間參考的規則：在第 0 天、保留 X 份 20 天
* 規則以擷取時間參照為基礎（預設）：在第 0 天、永遠保留 X 份複本


--
貯體生命週期:: `"Filter": {}, "Expiration": {"ExpiredObjectDeleteMarker": true}, "NoncurrentVersionExpiration": {"NoncurrentDays": 20}`
結果::
+
--
* ILM 原則會在貯體生命週期中複製。
+
** ILM 原則的 Forever 規則旨在手動移除物件、並在 20 天後清理非最新版本。因此、擷取時間規則會永遠保留過期的刪除標記。
** 貯體生命週期會在新增時重複 ILM 原則的行為 `"ExpiredObjectDeleteMarker": true`、這樣會在標記過期後移除刪除標記


* 正在擷取物件。無篩選器表示貯體生命週期會套用至所有物件、並會覆寫 ILM 保留設定。
+
** 當租戶發出物件刪除要求時、會建立刪除標記、且物件變成非目前的物件。
** 20 天後、非目前物件會刪除、刪除標記會過期。
** 之後不久、過期的刪除標記就會刪除。




--

