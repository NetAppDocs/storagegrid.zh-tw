---
permalink: ilm/create-ilm-rule-define-placements.html 
sidebar: sidebar 
keywords: ilm rule step 2, define placements 
summary: 「建立 ILM 規則」精靈的「定義放置位置」步驟可讓您定義放置指示、以決定物件的儲存時間、複本類型 \ （複寫或刪除編碼 \ ）、儲存位置和複本數量。 
---
= 步驟2（共3步）：定義放置位置
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
「建立 ILM 規則」精靈的 * 定義放置位置 * 步驟可讓您定義放置指示、以決定物件的儲存時間、複本類型（複寫或刪除編碼）、儲存位置及複本數量。


NOTE: 所示的螢幕擷取畫面為範例。您的結果可能會因 StorageGRID 版本而異。

.關於這項工作
ILM規則可以包含一或多個放置指示。每項放置指示均適用於單一時間段。當您使用多個指示時、時間段必須是連續的、且至少必須在第0天開始一項指示。指令可以永遠繼續、或直到您不再需要任何物件複本為止。

如果您想要建立不同類型的複本、或在該期間使用不同的位置、每個放置指示都可以有多行。

在此範例中、 ILM 規則會在站台 1 中儲存一個複寫複本、並在站台 2 中儲存第一年的複寫複本。一年後、便會製作2+1銷毀編碼的複本、並僅儲存於一個站台。

image::../media/ilm_create_ilm_rule_wizard_2.png[建立 ILM 規則精靈步驟 2]

.步驟
. 對於 * 參考時間 * 、請選取在計算放置指示的開始時間時要使用的時間類型。
+
[cols="1a,2a"]
|===
| 選項 | 說明 


 a| 
擷取時間
 a| 
擷取物件的時間。



 a| 
上次存取時間
 a| 
上次擷取（讀取或檢視）物件的時間。

若要使用此選項、必須為 S3 儲存區啟用上次存取時間的更新。請參閱 link:using-last-access-time-in-ilm-rules.html["在 ILM 規則中使用上次存取時間"]。



 a| 
使用者定義的建立時間
 a| 
使用者定義中繼資料中指定的時間。



 a| 
非目前時間
 a| 
如果您在中針對「僅將此規則套用至較舊的物件版本（在啟用版本設定的 S3 儲存區中）？」問題選取 * 「是 * 」link:create-ilm-rule-enter-details.html["建立 ILM 規則精靈的步驟 1"]、則會自動選取「非目前時間」。

|===
+
如果您想要建立 _ 相容 _ 規則、您必須選取 * 擷取時間 * 。請參閱 link:managing-objects-with-s3-object-lock.html["使用S3物件鎖定來管理物件"]。

. 在「 * 期間與刊登位置 * 」區段中、輸入第一個時間週期的開始時間與持續時間。
+
例如、您可能想要指定第一年的物件儲存位置（ _ 從第 0 天儲存 365 天 _ ）。至少必須在第0天開始執行一項指示。

. 若要建立複寫複本：
+
.. 從 * 依 * 儲存物件下拉式清單中、選取 * 複寫 * 。
.. 選取您要製作的份數。
+
如果您將複本數目變更為1、就會出現警告。ILM規則只會在任何時間段建立一個複寫複本、使資料有永久遺失的風險。請參閱 link:why-you-should-not-use-single-copy-replication.html["為何不應使用單一複製複寫"]。

+
若要避免風險、請執行下列一或多項操作：

+
*** 增加期間的複本數量。
*** 將複本新增至其他儲存池或雲端儲存池。
*** 選擇 * 銷毀編碼 * 、而非 * 複製 * 。
+
如果此規則已為所有時間段建立多個複本、您可以安全地忽略此警告。



.. 在 * 複本於 * 欄位中、選取您要新增的儲存池。
+
*如果您只指定一個儲存資源池*、請注意StorageGRID 、在任何指定的儲存節點上、只能儲存物件的一個複製複本。如果您的網格包含三個儲存節點、而且您選取 4 做為複本數量、則只會製作三份複本？ #8212 ；每個儲存節點一份複本。

+
觸發「無法實現的ILM放置」警示、表示無法完全套用ILM規則。

+
*如果您指定多個儲存資源池*、請謹記下列規則：

+
*** 複本數量不得大於儲存集區數量。
*** 如果複本數量等於儲存資源池數量、則每個儲存資源池中會儲存一個物件複本。
*** 如果複本數小於儲存集區的數量、則會在擷取站台儲存一個複本、然後系統會散佈其餘複本、以保持集區之間的磁碟使用率平衡、同時確保站台不會取得超過一個物件複本。
*** 如果儲存資源池重疊（包含相同的儲存節點）、則物件的所有複本可能只會儲存在一個站台。因此、請勿指定「所有儲存節點」儲存池（ StorageGRID 11.6 以上版本）和其他儲存池。




. 如果您要建立銷毀編碼複本：
+
.. 從 * 依 * 儲存物件下拉式清單中、選取 * 銷毀編碼 * 。
+

NOTE: 銷毀編碼最適合大於1 MB的物件。請勿對小於 200 KB 的物件使用抹除編碼、以避免管理非常小的銷毀編碼片段所造成的負擔。

.. 如果您未新增大於 200 KB 的物件大小篩選器、請選取 * 上一步 * 以返回步驟 1 。然後選擇 * 新增進階篩選器 * 、並將 * 物件大小 * 篩選器設定為任何大於 200 KB 的值。
.. 選取您要新增的儲存資源池、以及您要使用的銷毀編碼配置。
+
銷毀編碼複本的儲存位置包括抹除編碼配置的名稱、以及儲存池的名稱。

+
可用的銷毀編碼配置受限於您所選儲存池中的儲存節點數量。在提供的方案旁邊會出現一個 `Recommended`徽章link:../ilm/what-erasure-coding-schemes-are.html["最佳保護或最低的儲存負荷"]。



. （可選）：
+
.. 選取 * 新增其他類型或位置 * 、在不同位置建立其他複本。
.. 選取 * 新增其他時間週期 * 以新增不同的時間週期。
+
[NOTE]
====
物件刪除是根據下列設定進行：

*** 物件會在最後一個時間週期結束時自動刪除、除非另一個時間週期以 * 永遠 * 結束。
*** link:../ilm/example-8-priorities-for-s3-bucket-lifecycle-and-ilm-policy.html#example-of-bucket-lifecycle-taking-priority-over-ilm-policy["貯體與租戶保留期間設定"]即使 ILM 保留期間結束、物件也可能無法刪除、視情況而定。


====


. 若要將物件儲存在雲端儲存資源池中：
+
.. 在 * 依 * 儲存物件下拉式清單中、選取 * 複寫 * 。
.. 選取 * 複本於 * 欄位、然後選取雲端儲存池。
+
使用雲端儲存資源池時、請謹記下列規則：

+
*** 您無法在單一放置指示中選取多個雲端儲存池。同樣地、您也無法在相同的放置指示中選取雲端儲存池和儲存池。
*** 您只能在任何指定的Cloud Storage Pool中儲存物件的一份複本。如果您將*份數*設為2個以上、就會出現錯誤訊息。
*** 您無法在任何雲端儲存池中同時儲存多個物件複本。如果使用雲端儲存資源池的多個放置位置日期重疊、或同一放置位置的多行使用雲端儲存資源池、則會出現錯誤訊息。
*** 您可以在將物件儲存為 StorageGRID 中的複寫或銷毀編碼複本的同時、將物件儲存在雲端儲存池中。不過、您必須在期間的放置指示中包含多行、才能指定每個位置的份數和類型。




. 在保留圖中、確認您的放置指示。
+
在此範例中、 ILM 規則會在站台 1 中儲存一個複寫複本、並在站台 2 中儲存第一年的複寫複本。一年後、再加上 10 年後、將會在三個地點儲存 6+3 銷毀編碼複本。總共 11 年之後、物件將從 StorageGRID 中刪除。

+
保留圖的規則分析區段說明：

+
** StorageGRID 站台遺失保護將在本規則期間適用。
** 此規則處理的物件將在第 4015 天之後刪除。
+
請參閱 link:using-multiple-storage-pools-for-cross-site-replication.html["啟用站台遺失保護。"]

+
image::../media/ilm_rule_retention_diagram.png[ILM規則保留圖]



. 選擇*繼續*。link:create-ilm-rule-select-ingest-behavior.html["步驟 3 （選擇擷取行為）"]將顯示「建立 ILM 規則」精靈的。

