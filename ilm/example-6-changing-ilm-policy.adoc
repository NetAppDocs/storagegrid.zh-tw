---
permalink: ilm/example-6-changing-ilm-policy.html 
sidebar: sidebar 
keywords: change ILM policy, example ILM policy, information lifecycle policy example 
summary: 如果您需要變更資料保護、或是新增網站、您可以建立並啟動新的 ILM 原則。 
---
= 範例 6 ：變更 ILM 原則
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果您需要變更資料保護、或是新增網站、您可以建立並啟動新的 ILM 原則。

變更原則之前、您必須先瞭解ILM放置位置的變更如何暫時影響StorageGRID 到整個作業系統的效能。

在此範例中、擴充中新增了一個 StorageGRID 站台、需要實作新的主動式 ILM 原則、以便將資料儲存在新站台上。若要實作新的作用中原則，請先link:creating-ilm-policy.html["建立原則"]。之後、您必須link:../ilm/creating-ilm-policy.html#simulate-ilm-policy["模擬"]執行link:../ilm/creating-ilm-policy.html#activate-ilm-policy["啟動"]新原則。


CAUTION: 下列ILM規則和原則僅為範例。有許多方法可以設定ILM規則。在啟動新原則之前、請先進行模擬、確認其運作方式符合保護內容免於遺失的目的。



== 變更 ILM 原則會如何影響效能

當您啟動新的ILM原則時、StorageGRID 可能會暫時影響到您的系統效能、尤其是新原則中的放置指示需要將許多現有物件移至新位置時。

當您啟動新的ILM原則時StorageGRID 、利用它來管理所有物件、包括現有物件和新擷取的物件。在啟動新的ILM原則之前、請先檢閱現有複寫和銷毀編碼物件放置位置的任何變更。變更現有物件的位置、可能會在評估和實作新放置位置時、導致暫時性資源問題。

為了確保新的 ILM 原則不會影響現有複寫和刪除編碼物件的放置，您可以link:create-ilm-rule-enter-details.html#use-advanced-filters-in-ilm-rules["建立內含擷取時間篩選器的 ILM 規則"]。例如、 * 擷取時間 _ 在 _ _ _ <date and time> _ 之後、所以新規則僅適用於在指定日期和時間之後擷取的物件。

可能暫時影響StorageGRID 到性能不佳的ILM原則變更類型包括：

* 將不同的抹除編碼設定檔套用至現有的抹除編碼物件。
+

NOTE: StorageGRID 認為每個銷毀編碼設定檔都是唯一的、而且在使用新設定檔時、不會重複使用銷毀編碼片段。

* 變更現有物件所需的複本類型；例如、將大量複寫物件轉換成銷毀編碼物件。
* 將現有物件的複本移至完全不同的位置、例如、將大量物件移入或移出Cloud Storage Pool、或移至或移出遠端站台。




== 範例6的Active ILM原則：兩個站台的資料保護

在此範例中、主動式ILM原則最初是針對雙站台StorageGRID 的作業系統而設計、並使用兩個ILM規則。

image::../media/policy_6_active_policy.png[ILM原則6作用中原則範例]

在此ILM原則中、屬於租戶A的物件在單一站台上受到2+1銷毀編碼的保護、而屬於所有其他租戶的物件則使用雙複製複寫在兩個站台上受到保護。



=== 規則1：租戶A的單一站台銷毀編碼

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
租戶A的單一站台銷毀編碼



 a| 
租戶帳戶
 a| 
租戶A



 a| 
儲存資源池
 a| 
站台 1



 a| 
刊登位置
 a| 
2+1 從第 0 天到永遠在站台 1 進行銷毀編碼

|===


=== 規則2：為其他租戶進行雙站台複寫

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
其他租戶的雙站台複寫



 a| 
租戶帳戶
 a| 
忽略



 a| 
儲存資源池
 a| 
站台 1 和站台 2



 a| 
刊登位置
 a| 
從第 0 天到永遠複寫兩份複本：在站台 1 複製一份複本、在站台 2 複製一份複本。

|===


== ILM 原則範例 6 ：三個站台的資料保護

在此範例中、 ILM 原則正被三站台 StorageGRID 系統的新原則所取代。

在執行擴充以新增站台之後、網格管理員建立了兩個新的儲存集區：站台 3 的儲存集區、以及包含所有三個站台的儲存集區（與所有儲存節點預設儲存集區不同）。然後、管理員建立了兩個新的 ILM 規則和一個新的 ILM 原則、其設計是為了保護所有三個站台的資料。

啟動此新的ILM原則時、屬於租戶A的物件會在三個站台上受到2+1銷毀編碼的保護、屬於其他租戶（以及屬於租戶A的較小物件）的物件則會在三個站台上使用3個複製複寫來加以保護。



=== 規則1：租戶A的三站台銷毀編碼

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
租戶A的三站台銷毀編碼



 a| 
租戶帳戶
 a| 
租戶A



 a| 
儲存資源池
 a| 
全部 3 個站台（包括站台 1 、站台 2 和站台 3 ）



 a| 
刊登位置
 a| 
從第 0 天到永遠、所有 3 個站台的 2+1 銷毀編碼

|===


=== 規則2：其他租戶的三站台複寫

[cols="1a,2a"]
|===
| 規則定義 | 範例值 


 a| 
規則名稱
 a| 
其他租戶的三站台複寫



 a| 
租戶帳戶
 a| 
忽略



 a| 
儲存資源池
 a| 
站台 1 、站台 2 和站台 3



 a| 
刊登位置
 a| 
從第 0 天到永久複製三份複本：在站台 1 複製一份、在站台 2 複製一份、在站台 3 複製一份。

|===


== 啟動 ILM 原則、例如 6

當您啟動新的 ILM 原則時、現有的物件可能會移至新位置、或是根據任何新的或更新的規則中的放置指示、為現有物件建立新的物件複本。


CAUTION: ILM原則中的錯誤可能導致無法恢復的資料遺失。在啟動原則之前、請仔細檢閱並模擬原則、以確認其運作正常。


CAUTION: 當您啟動新的ILM原則時StorageGRID 、利用它來管理所有物件、包括現有物件和新擷取的物件。在啟動新的ILM原則之前、請先檢閱現有複寫和銷毀編碼物件放置位置的任何變更。變更現有物件的位置、可能會在評估和實作新放置位置時、導致暫時性資源問題。



=== 當銷毀編碼指令變更時會發生什麼事

在此範例中、目前作用中的 ILM 原則中、屬於租戶 A 的物件會使用站台 1 的 2+1 銷毀編碼來保護。在新的 ILM 原則中、屬於租戶 A 的物件將在站台 1 、 2 和 3 使用 2+1 銷毀編碼來保護。

啟動新的ILM原則時、會執行下列ILM作業：

* 租戶A擷取的新物件會分割成兩個資料分段、並新增一個同位元檢查分段。然後、這三個片段每個都會儲存在不同的站台上。
* 在進行中的ILM掃描程序中、會重新評估屬於租戶A的現有物件。由於 ILM 放置指示使用新的銷毀編碼設定檔、因此會建立全新的銷毀編碼片段、並將其散佈到三個站台。
+

NOTE: 站台 1 現有的 2+1 片段不會重複使用。StorageGRID 認為每個銷毀編碼設定檔都是唯一的、而且在使用新設定檔時、不會重複使用銷毀編碼片段。





=== 複寫指示變更時會發生什麼事

在此範例中、目前作用中的 ILM 原則中、屬於其他租戶的物件會使用站台 1 和 2 儲存池中的兩個複寫複本來保護。在新的 ILM 原則中、屬於其他租戶的物件將使用站台 1 、 2 和 3 儲存池中的三個複寫複本加以保護。

啟動新的ILM原則時、會執行下列ILM作業：

* 當租戶以外的任何租戶都有新物件時、 StorageGRID 會建立三個複本、並在每個站台上儲存一份複本。
* 在進行中的ILM掃描程序中、會重新評估屬於這些其他租戶的現有物件。由於站台 1 和站台 2 的現有物件複本仍可滿足新 ILM 規則的複寫需求、因此 StorageGRID 只需為站台 3 建立一個新的物件複本。




=== 啟用此原則對效能的影響

當本範例中的 ILM 原則啟動時、此 StorageGRID 系統的整體效能將暫時受到影響。若要為租戶 A 的現有物件建立新的銷毀編碼片段、以及在站台 3 為其他租戶現有物件建立新的複寫複本、則需要比一般網格資源層級更高的網格資源層級。

由於ILM原則變更、用戶端讀取和寫入要求可能會暫時超過正常延遲時間。在整個網格中完全實作放置指示之後、延遲時間會恢復正常。

若要在啟動新的 ILM 原則時避免資源問題、您可以在任何可能變更大量現有物件位置的規則中使用「擷取時間」進階篩選器。將「擷取時間」設定為大於或等於新原則生效的大約時間、以確保現有物件不會不必要地移動。


NOTE: 如果您需要減緩或提高ILM原則變更後處理物件的速度、請聯絡技術支援部門。
