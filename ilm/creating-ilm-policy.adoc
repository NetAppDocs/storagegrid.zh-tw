---
permalink: ilm/creating-ilm-policy.html 
sidebar: sidebar 
keywords: how to create ILM policy 
summary: 建立一或多個 ILM 原則以符合您的服務品質要求。 
---
= 建立 ILM 原則
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
建立一或多個 ILM 原則以符合您的服務品質要求。

有一個主動式 ILM 原則可讓您將相同的 ILM 規則套用至所有租戶和貯體。

擁有多個主動式 ILM 原則可讓您將適當的 ILM 規則套用至特定租戶和貯體、以滿足多項服務品質要求。



== 建立ILM原則

.關於這項工作
在建立自己的原則之前、請確認link:ilm-policy-overview.html#default-ilm-policy["預設 ILM 原則"]不符合您的儲存需求。


NOTE: 在測試系統中、只能使用系統提供的原則、 2 份複本原則（適用於單一站台網格）或每個站台 1 份複本（適用於多站台網格）。對於 StorageGRID 11.6 及更早版本、此原則中的預設規則會使用「所有儲存節點」儲存池、其中包含所有站台。如果StorageGRID 您的作業系統有多個站台、則一個物件的兩份複本可能會放在同一個站台上。


NOTE: 如果link:enabling-s3-object-lock-globally.html["全域 S3 物件鎖定設定已啟用"]是、您必須確保 ILM 原則符合已啟用 S3 物件鎖定的儲存區需求。在本節中、請遵循已啟用 S3 物件鎖定的指示。

.開始之前
* 您已使用登入 Grid Manager link:../admin/web-browser-requirements.html["支援的網頁瀏覽器"]。
* 您有link:../admin/admin-group-permissions.html["必要的存取權限"]。
* 您是否已link:access-create-ilm-rule-wizard.html["已建立 ILM 規則"]啟用 S3 物件鎖定。
+
[role="tabbed-block"]
====
.S3 物件鎖定未啟用
--
** 您已link:what-ilm-rule-is.html["已建立 ILM 規則"]想要新增至原則。您可以視需要儲存原則、建立其他規則、然後編輯原則以新增規則。
** 您的link:creating-default-ilm-rule.html["已建立預設ILM規則"]篩選器不包含任何篩選器。


--
.S3 物件鎖定已啟用
--
** link:enabling-s3-object-lock-globally.html["全域 S3 物件鎖定設定已啟用"]適用於 StorageGRID 系統的。
** 您已link:what-ilm-rule-is.html["已建立相容且不符合法規的 ILM 規則"]想要新增至原則。您可以視需要儲存原則、建立其他規則、然後編輯原則以新增規則。
** 您擁有link:creating-default-ilm-rule.html["已建立預設ILM規則"]符合法規的原則。


--
====
* 或者，您已經觀看了影片：


.ILM 策略概述
video::e768d4da-da88-413c-bbaa-b1ff00874d10[panopto]
另請參閱link:ilm-policy-overview.html["使用 ILM 原則"]。

.步驟
. 選擇* ILM *>* Policies *。
+
如果啟用全域 S3 物件鎖定設定、則「 ILM 原則」頁面會指出哪些 ILM 規則符合規定。

. 決定您要如何建立 ILM 原則。
+
[role="tabbed-block"]
====
.建立新原則
--
.. 選取 * 建立原則 * 。


--
.複製現有原則
--
.. 選中要開始的策略的複選框，然後選擇 *Clone* 。


--
.編輯現有原則
.. 如果原則處於非作用中狀態、您可以加以編輯。選取您要開始使用的非作用中原則核取方塊、然後選取 * 編輯 * 。


====


. 在 * 原則名稱 * 欄位中、輸入原則的唯一名稱。
. 或者、在 * 變更理由 * 欄位中、輸入您建立新原則的原因。
. 若要將規則新增至原則、請選取 * 選取規則 * 。選取規則名稱以檢視該規則的設定。
+
--
如果您要複製原則：

** 您正在複製的原則所使用的規則會被選取。
** 如果您正在複製的原則使用的任何規則都沒有非預設規則的篩選器、系統會提示您移除其中一個規則以外的所有規則。
** 如果預設規則使用篩選器、系統會提示您選取新的預設規則。
** 如果預設規則不是最後一個規則、您可以將規則移至新原則的結尾。


--
+
[role="tabbed-block"]
====
.S3 物件鎖定未啟用
--
.. 為原則選取一個預設規則。若要建立新的預設規則、請選取 * ILM 規則頁面 * 。
+
預設規則會套用至任何不符合原則中其他規則的物件。預設規則無法使用任何篩選條件、而且一律是最後評估的。

+

NOTE: 請勿使用「製作 2 份複本」規則做為原則的預設規則。「製作2份複本」規則使用單一儲存資源池「所有儲存節點」、其中包含所有站台。如果StorageGRID 您的作業系統有多個站台、則一個物件的兩份複本可能會放在同一個站台上。



--
.S3 物件鎖定已啟用
--
.. 為原則選取一個預設規則。若要建立新的預設規則、請選取 * ILM 規則頁面 * 。
+
規則清單僅包含符合規定且不使用任何篩選器的規則。

+

NOTE: 請勿使用「製作 2 份複本」規則做為原則的預設規則。「製作2份複本」規則使用單一儲存資源池「所有儲存節點」、其中包含所有站台。如果您使用此規則、一個物件的多個複本可能會放置在同一個站台上。

.. 如果您在不符合標準的 S3 儲存區中的物件需要不同的「預設」規則、請選取 * 包含不含不符合標準 S3 儲存區篩選器的規則 * 、然後選取不使用篩選器的不符合標準規則。
+
例如、您可能想要使用雲端儲存池、將物件儲存在未啟用 S3 物件鎖定的儲存區中。

+

NOTE: 您只能選取一個不符合規定的規則、而不使用篩選器。



另請參閱link:example-7-compliant-ilm-policy-for-s3-object-lock.html["範例7：S3物件鎖定的符合ILM原則"]。

--
====


. 完成選取預設規則後、請選取 * 繼續 * 。
. 針對「其他規則」步驟、選取您要新增至原則的任何其他規則。這些規則至少使用一個篩選器（租戶帳戶、貯體名稱、進階篩選器或非目前參考時間）。然後選擇 * 選擇 * 。
+
「建立原則」視窗現在會列出您選取的規則。預設規則結尾為、其上方則為其他規則。

+
如果啟用 S3 物件鎖定、而且您也選取了不相容的「預設」規則、則該規則會新增為原則中的第二對最後一條規則。

+

NOTE: 如果有任何規則無法永遠保留物件、則會出現警告。當您啟動此原則時、必須確認在預設規則的放置指示到期時、您希望 StorageGRID 刪除物件（除非貯體生命週期將物件保留較長的時間）。

. 拖曳非預設規則的列、以決定評估這些規則的順序。
+
您無法移動預設規則。如果啟用 S3 物件鎖定、如果選取不符合的「預設」規則、您也無法移動該規則。

+

NOTE: 您必須確認ILM規則的順序正確。當原則啟動時、新物件和現有物件會依照列出的順序進行評估、從上方開始。

. 視需要選取 * 選取規則 * 以新增或移除規則。
. 完成後、請選取*「Save（儲存）」*。
. 重複這些步驟以建立其他 ILM 原則。
. <<simulate-ilm-policy,模擬ILM原則>>。您應該一律在啟動原則之前先模擬原則、以確保其正常運作。




== 模擬原則

在啟動原則並將其套用至正式作業資料之前、先模擬測試物件的原則。

.開始之前
* 您知道要測試的每個物件的 S3 貯體 / 物件金鑰。


.步驟
. 使用 S3 用戶端或link:../tenant/use-s3-console.html["S3 主控台"]、擷取測試每個規則所需的物件。
. 在「 ILM 原則」頁面上、選取原則的核取方塊、然後選取 * 模擬 * 。
. 在 * 物件 * 欄位中、輸入測試物件的 S3 `bucket/object-key` 。例如 `bucket-01/filename.png`：。
. 如果啟用 S3 版本設定、可選擇在 * 版本 ID* 欄位中輸入物件的版本 ID 。
. 選擇*模擬*。
. 在 Simulation 結果區段中、確認每個物件都符合正確的規則。
. 若要判斷哪個儲存池或銷毀編碼設定檔有效、請選取相符規則的名稱、以移至規則詳細資料頁面。



CAUTION: 檢閱現有複寫和刪除編碼物件位置的任何變更。變更現有物件的位置、可能會在評估和實作新放置位置時、導致暫時性資源問題。

.結果
對原則規則所做的任何編輯、都會反映在 Simulation 結果中、並顯示新的比對和先前的比對。「模擬原則」視窗會保留您測試的物件、直到您為 Simulation 結果清單中的每個物件選取 * 全部清除 * 或移除圖示為止image:../media/icon-x-to-remove.png["移除圖示"]。

.相關資訊
link:simulating-ilm-policy-examples.html["ILM 原則模擬範例"]



== 啟動原則

當您啟動單一新的 ILM 原則時、現有物件和新擷取的物件都會由該原則管理。當您啟動多個原則時、指派給儲存區的 ILM 原則標記會決定要管理的物件。

啟動新原則之前：

. 模擬原則、確認其運作方式符合您的預期。
. 檢閱現有複寫和刪除編碼物件位置的任何變更。變更現有物件的位置、可能會在評估和實作新放置位置時、導致暫時性資源問題。



CAUTION: ILM原則中的錯誤可能導致無法恢復的資料遺失。

.關於這項工作
當您啟動ILM原則時、系統會將新原則發佈至所有節點。不過、在所有網格節點都可以接收新原則之前、新的作用中原則可能不會實際生效。在某些情況下、系統會等待實作新的作用中原則、以確保網格物件不會意外移除。具體而言：

* 如果您進行的原則變更 * 會增加資料備援或耐用度 * 、則這些變更會立即實作。例如、如果您啟動包含三份複本規則的新原則、而非雙份複本規則、則該原則將會立即實作、因為它會增加資料備援。
* 如果您進行的原則變更 * 可能會降低資料備援或耐用度 * 、則這些變更將不會實作、直到所有網格節點都可用為止。例如、如果您啟動使用雙份複本規則而非三份複本規則的新原則、則新原則會出現在「作用中原則」索引標籤中、但直到所有節點都已上線且可供使用為止、該原則才會生效。


.步驟
請依照下列步驟啟動一或多個原則：

[role="tabbed-block"]
====
.啟動一個原則
--
如果您只有一個作用中原則、請遵循下列步驟。如果您已經有一個或多個作用中原則、而且您正在啟動其他原則、請依照步驟來啟動多個原則。

. 當您準備好啟動原則時、請選取 * ILM * > * 原則 * 。
+
或者、您也可以從「 * ILM * > * 原則標記 * 」頁面啟動單一原則。

. 在 " 原則 " 索引標籤上 , 選取您要啟動之原則的核取方塊 , 然後選取 *Activate* 。
. 請遵循適當步驟：
+
** 如果出現警告訊息提示您確認要啟動原則、請選取 * 確定 * 。
** 如果出現包含原則詳細資料的警告訊息：
+
... 檢閱詳細資料、確保原則能如預期般管理資料。
... 如果預設規則儲存物件的天數有限、請檢閱保留圖表、然後在文字方塊中輸入該天數。
... 如果預設規則會永久儲存物件、但有一或多個其他規則的保留限制、請在文字方塊中輸入 * 是 * 。
... 選取 * 啟動原則 * 。






--
.啟動多個原則
--
要啟動多個策略，您必須建立策略標籤並為每個標籤指派一個策略。您最多可以為網格建立 10 個策略標籤。


TIP: 當使用多個策略標籤時，如果租戶經常將策略標籤重新指派給儲存桶，則網格效能可能會受到影響。如果您有不受信任的租戶，請考慮僅使用預設策略標籤。

. 選取 * ILM * > * 原則標記 * 。
. 選擇* Create *（建立*）。
. 在 [ 建立原則標記 ] 對話方塊中，輸入標記名稱，並選擇性地輸入標記的描述。
+

NOTE: 租戶可以看到標籤名稱和說明。選擇可協助租戶在選擇原則標籤指派給他們的貯體時、做出明智決策的值。例如、如果指派的原則會在一段時間後刪除物件、您可以在說明中告知該物件。請勿在這些欄位中包含敏感資訊。

. 選取 * 建立標記 * 。
. 在 ILM 原則標籤表格中、使用下拉式清單來選取要指派給標籤的原則。
. 如果「原則限制」欄中出現警告、請選取 * 檢視原則詳細資料 * 以檢閱原則。
. 確保每個原則都能如預期般管理資料。
. 選取 * 啟動指派的原則 * 。或者、選取 * 清除變更 * 以移除原則指派。
. 在 [ 使用新標記啟動原則 ] 對話方塊中，檢閱每個標記、原則和規則如何管理物件的描述。視需要進行變更、以確保原則能如預期般管理物件。
. 當您確定要啟動原則時、請在文字方塊中鍵入 * 是 * 、然後選取 * 啟動原則 * 。


--
====
.相關資訊
link:example-6-changing-ilm-policy.html["範例6：變更ILM原則"]
