---
permalink: ubuntu/node-container-migration-requirements.html 
sidebar: sidebar 
keywords: node container migration requirements 
summary: 節點移轉功能可讓您手動將節點從一部主機移至另一部主機。一般而言、這兩個主機都位於同一個實體資料中心。 
---
= 節點容器移轉需求
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
節點移轉功能可讓您手動將節點從一部主機移至另一部主機。一般而言、這兩個主機都位於同一個實體資料中心。

節點移轉可讓您在不中斷網格作業的情況下執行實體主機維護。將所有 StorageGRID 節點（一次一個）移至另一主機、然後再將實體主機離線。移轉節點只需要短暫的停機時間、不應影響網格服務的運作或可用度。

如果您想要使用StorageGRID 「資訊節點移轉」功能、您的部署必須符合其他需求：

* 在單一實體資料中心的主機之間、提供一致的網路介面名稱
* 共享儲存功能、適用於StorageGRID 單一實體資料中心內所有主機皆可存取的中繼資料和物件儲存庫磁碟區。例如、您可以使用NetApp E系列儲存陣列。


如果您使用的是虛擬主機、而基礎 Hypervisor 層支援 VM 移轉、則可能需要使用此功能、而非 StorageGRID 中的節點移轉功能。在此情況下、您可以忽略這些額外需求。

在執行移轉或Hypervisor維護之前、請先正常關閉節點。請參閱的說明link:../maintain/shutting-down-grid-node.html["關閉網格節點"]。



== 不支援VMware即時移轉

在 VMware VM 上執行裸機安裝時、 OpenStack Live Migration 和 VMware Live VMotion 會導致虛擬機器時鐘時間跳轉、而且不支援任何類型的網格節點。雖然不多見、但時鐘時間不正確可能導致資料遺失或組態更新。

支援冷移轉。在冷移轉中、StorageGRID 您需要先關閉各個節點、然後再在主機之間進行移轉。請參閱的說明link:../maintain/shutting-down-grid-node.html["關閉網格節點"]。



== 一致的網路介面名稱

若要將節點從一部主機移至另一部主機、 StorageGRID 主機服務需要對節點目前所在位置的外部網路連線能力、在新位置進行複製有一定信心。在主機中使用一致的網路介面名稱、就能獲得這種信心。

舉例來StorageGRID 說、假設在主機1上執行的支援節點a已設定下列介面對應：

image::../media/eth0_bond.gif[此影像由周邊文字說明。]

箭頭的左側對應StorageGRID 於從一個包含網格、管理和用戶端網路介面的資訊（分別為網格、管理和用戶端網路介面）的舊介面。箭頭的右側對應於提供這些網路的實際主機介面、這些網路是三個附屬於同一個實體介面連結的VLAN介面。

現在、假設您要將節點A移轉至主機2。如果主機2也有名為bond0.1001、bond0.1002和bond0.1003的介面、則系統會允許移動、假設同名介面將在主機2上提供與主機1相同的連線能力。如果主機2沒有名稱相同的介面、則不允許移動。

有許多方法可以在多個主機之間實現一致的網路介面命名；如需一些範例、請參閱link:configuring-host-network.html["設定主機網路"]。



== 共享儲存設備

為了實現快速、低成本的節點移轉、 StorageGRID 節點移轉功能不會實際移動節點資料。相反地、節點移轉是以一對匯出與匯入作業的形式執行、如下所示：

.步驟
. 在「節點匯出」作業期間、會從主機 A 上執行的節點容器擷取少量的持續狀態資料、並快取到該節點的系統資料 Volume 上。然後、將會對主機A上的節點容器進行個體化。
. 在「節點匯入」作業期間、主機 B 上使用與主機 A 相同網路介面和區塊儲存對應的節點容器會產生。然後、快取的持續狀態資料會插入新執行個體。


在這種操作模式下、必須可從主機A和主機B存取節點的所有系統資料和物件儲存磁碟區、才能允許移轉及運作。此外、它們必須使用名稱對應至節點、這些名稱必須保證能參照主機A和主機B上相同的LUN。

以下範例顯示 StorageGRID 儲存節點的區塊裝置對應解決方案、其中主機上正在使用 DM 多重路徑、而別名欄位已用於 `/etc/multipath.conf`提供所有主機上一致且易記的區塊裝置名稱。

image::../media/block_device_mapping_rhel.gif[此影像由周邊文字說明。]
