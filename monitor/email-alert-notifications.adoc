---
permalink: monitor/email-alert-notifications.html 
sidebar: sidebar 
keywords: how to disable alert rules, how to remove a custom alert rule 
summary: 如果您想要在警示發生時傳送電子郵件通知、您必須提供有關您的SMTP伺服器的資訊。您也必須輸入警示通知收件者的電子郵件地址。 
---
= 設定警示的電子郵件通知
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
如果您想要在警示發生時傳送電子郵件通知、您必須提供有關您的SMTP伺服器的資訊。您也必須輸入警示通知收件者的電子郵件地址。

.開始之前
* 您已使用登入 Grid Manager link:../admin/web-browser-requirements.html["支援的網頁瀏覽器"]。
* 您有link:../admin/admin-group-permissions.html["管理警示或根目錄存取權限"]。


.關於這項工作
用於警示通知的電子郵件設定不適用於 AutoSupport 套件。不過、您可以使用相同的電子郵件伺服器來處理所有通知。

如果您的 StorageGRID 部署包含多個管理節點、則主要管理節點是警示通知、 AutoSupport 套件和 SNMP 設陷及通知的慣用寄件者。如果主要管理節點無法使用、則其他管理節點會暫時傳送通知。請參閱。 link:../primer/what-admin-node-is.html["什麼是管理節點？"]

.步驟
. 選擇* alerts *>*電子郵件設定*。
+
此時會出現「電子郵件設定」頁面。

. 選取 * 啟用電子郵件通知 * 核取方塊、表示您希望在警示達到設定的臨界值時傳送通知電子郵件。
+
此時會出現「電子郵件（SMTP）伺服器」、「傳輸層安全性（TLS）」、「電子郵件地址」和「篩選器」區段。

. 在「電子郵件（SMTP）伺服器」區段中、輸入StorageGRID 存取您的SMTP伺服器所需的資訊。
+
如果您的SMTP伺服器需要驗證、您必須同時提供使用者名稱和密碼。

+
[cols="1a,2a"]
|===
| 欄位 | 輸入 


 a| 
郵件伺服器
 a| 
完整網域名稱（FQDN）或SMTP伺服器的IP位址。



 a| 
連接埠
 a| 
用於存取SMTP伺服器的連接埠。必須介於1到65535.



 a| 
使用者名稱（選用）
 a| 
如果您的SMTP伺服器需要驗證、請輸入要驗證的使用者名稱。



 a| 
密碼（選用）
 a| 
如果您的SMTP伺服器需要驗證、請輸入要驗證的密碼。

|===
. 在「電子郵件地址」區段中、輸入寄件者和每位收件者的電子郵件地址。
+
.. 對於*寄件者電子郵件地址*、請指定有效的電子郵件地址作為警示通知的寄件者地址。
+
例如： `storagegrid-alerts@example.com`

.. 在「收件者」區段中、輸入每個電子郵件清單的電子郵件地址、或在發生警示時應接收電子郵件的人員。
+
選取加號圖示image:../media/icon_plus_sign_black_on_white.gif["加號圖示"]以新增收件者。



. 如果需要傳輸層安全性（TLS）才能與SMTP伺服器通訊、請在傳輸層安全性（TLS）區段中選取*需要TLS*。
+
.. 在「* CA憑證*」欄位中、提供用於驗證SMTP伺服器識別的CA憑證。
+
您可以複製內容並貼到這個欄位、或選取*瀏覽*並選取檔案。

+
您必須提供單一檔案、其中包含來自每個中繼發行憑證授權單位（CA）的憑證。檔案應包含以憑證鏈順序串聯的每個由PEE編碼的CA憑證檔案。

.. 如果您的 SMTP 電子郵件伺服器需要電子郵件寄件者提供用戶端憑證以進行驗證、請選取 * 傳送用戶端憑證 * 核取方塊。
.. 在*用戶端憑證*欄位中、提供要傳送至SMTP伺服器的PEP-編碼用戶端憑證。
+
您可以複製內容並貼到這個欄位、或選取*瀏覽*並選取檔案。

.. 在*私密金鑰*欄位中、以未加密的PEM編碼輸入用戶端憑證的私密金鑰。
+
您可以複製內容並貼到這個欄位、或選取*瀏覽*並選取檔案。

+

NOTE: 如果您需要編輯電子郵件設定、請選取鉛筆圖示image:../media/icon_edit_tm.png["編輯圖示"]以更新此欄位。



. 在「篩選」區段中、選取應產生電子郵件通知的警示嚴重性層級、除非特定警示的規則已設為靜音。
+
[cols="1a,2a"]
|===
| 嚴重性 | 說明 


 a| 
次要、主要、關鍵
 a| 
當符合警示規則的次要、主要或關鍵條件時、就會傳送電子郵件通知。



 a| 
重大、關鍵
 a| 
當符合警示規則的主要或關鍵條件時、就會傳送電子郵件通知。系統不會針對次要警示傳送通知。



 a| 
僅限關鍵
 a| 
只有在符合警示規則的關鍵條件時、才會傳送電子郵件通知。不會針對次要或主要警示傳送通知。

|===
. 當您準備好測試電子郵件設定時、請執行下列步驟：
+
.. 選擇*傳送測試電子郵件*。
+
隨即顯示確認訊息、表示已傳送測試電子郵件。

.. 勾選所有電子郵件收件者的收件匣、確認已收到測試電子郵件。
+

NOTE: 如果幾分鐘內未收到電子郵件、或觸發*電子郵件通知失敗*警示、請檢查您的設定、然後再試一次。

.. 登入任何其他管理節點、然後傳送測試電子郵件以驗證所有站台的連線能力。
+

NOTE: 測試警示通知時、您必須登入每個管理節點以驗證連線能力。這與測試 AutoSupport 套件形成對照、其中所有管理節點都會傳送測試電子郵件。



. 選擇*保存*。
+
傳送測試電子郵件並不會儲存您的設定。您必須選取*儲存*。

+
電子郵件設定即會儲存。





== 警示電子郵件通知中包含的資訊

設定好SMTP電子郵件伺服器之後、除非警示規則被靜音抑制、否則會在觸發警示時、將電子郵件通知傳送給指定的收件者。請參閱。 link:silencing-alert-notifications.html["靜音警示通知"]

電子郵件通知包含下列資訊：

image::../media/alerts_email_notification.png[警示電子郵件通知]

[cols="1a,6a"]
|===
| 標註 | 說明 


 a| 
1
 a| 
警示名稱、後面接著此警示的作用中執行個體數目。



 a| 
2
 a| 
警示的說明。



 a| 
3
 a| 
警示的任何建議動作。



 a| 
4
 a| 
每個警示作用中執行個體的詳細資料、包括受影響的節點和站台、警示嚴重性、觸發警示規則的UTC時間、以及受影響工作和服務的名稱。



 a| 
5
 a| 
傳送通知的管理節點主機名稱。

|===


== 警示的分組方式

為了避免在觸發警示時傳送過多的電子郵件通知、StorageGRID 所以當同一通知中、我們會嘗試將多個警示分組。

請參閱下表、瞭解StorageGRID 有關如何在電子郵件通知中將多個警示分組的範例。

[cols="1a,1a"]
|===
| 行為 | 範例 


 a| 
每個警示通知僅適用於名稱相同的警示。如果同時觸發兩個名稱不同的警示、則會傳送兩個電子郵件通知。
 a| 
* 同時在兩個節點上觸發警示A。只會傳送一則通知。
* 警示A會在節點1上觸發、而警示B會同時在節點2上觸發。會傳送兩個通知、每個警示各一個。




 a| 
對於特定節點的特定警示、如果達到超過一個嚴重性的臨界值、則只會針對最嚴重的警示傳送通知。
 a| 
* 警示A會觸發、並達到次要、主要和關鍵警示臨界值。系統會針對嚴重警示傳送一則通知。




 a| 
第一次觸發警示時StorageGRID 、不知何時會先等待2分鐘再傳送通知。如果在此期間觸發其他名稱相同的警示、StorageGRID 則會將初始通知中的所有警示分組
 a| 
. 警示 A 會在節點 1 的 08:00 觸發。不會傳送通知。
. 警示 A 會在節點 2 上於 08-01 觸發。不會傳送通知。
. 在 08 ： 02 時、系統會傳送通知、以回報警示的兩個執行個體。




 a| 
如果觸發另一個名稱相同的警示、StorageGRID 則在傳送新通知之前、將等候10分鐘。新通知會報告所有作用中的警示（目前尚未靜音的警示）、即使這些警示先前已報告。
 a| 
. 警示 A 會在節點 1 的 08:00 觸發。通知會在 08 ： 02 傳送。
. 警示 A 會於 08 ： 05 在節點 2 上觸發。第二則通知會在 08 ： 15 （ 10 分鐘後）傳送。兩個節點都會報告。




 a| 
如果有多個目前警示具有相同名稱、且其中一個警示已解決、則在警示已解決的節點上重新出現警示時、不會傳送新的通知。
 a| 
. 觸發節點 1 的警示 A 。系統會傳送通知。
. 觸發節點 2 的警示 A 。第二次通知即會傳送。
. 節點2的警示A已解決、但節點1的警示A仍為作用中狀態。
. 再次觸發節點2的警示A。由於節點1的警示仍在作用中、因此不會傳送新通知。




 a| 
在解決所有警示執行個體或將警示規則設為靜音之前、系統會每7天繼續傳送一次電子郵件通知。StorageGRID
 a| 
. 3月8日觸發節點1的警示A。系統會傳送通知。
. 警示A未解析或靜音。其他通知將於3月15日、3月22日、3月29日等時間傳送。


|===


== 疑難排解警示電子郵件通知

如果觸發*電子郵件通知失敗*警示、或您無法接收測試警示電子郵件通知、請依照下列步驟解決問題。

.開始之前
* 您已使用登入 Grid Manager link:../admin/web-browser-requirements.html["支援的網頁瀏覽器"]。
* 您有link:../admin/admin-group-permissions.html["管理警示或根目錄存取權限"]。


.步驟
. 驗證您的設定。
+
.. 選擇* alerts *>*電子郵件設定*。
.. 確認電子郵件（SMTP）伺服器設定正確。
.. 確認您已為收件者指定有效的電子郵件地址。


. 檢查垃圾郵件篩選器、確定電子郵件未傳送至垃圾郵件資料夾。
. 請要求您的電子郵件管理員確認寄件者地址的電子郵件並未遭到封鎖。
. 收集管理節點的記錄檔、然後聯絡技術支援部門。
+
技術支援人員可以使用記錄中的資訊來協助判斷發生問題的原因。例如、prometheus.log檔案在連線至您指定的伺服器時可能會顯示錯誤。

+
請參閱。 link:collecting-log-files-and-system-data.html["收集記錄檔和系統資料"]


